<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Drive-by Testing Array Explorer | Better world by better software</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="TLDR; testing a popular web app using Cypress.   Array Explorer The setup First test Second test Covering primary methods Use JavaScript Simplifying test using aliases Generating tests Fake time Need">
<meta name="keywords" content="testing,cypress,vuejs">
<meta property="og:type" content="article">
<meta property="og:title" content="Drive-by Testing Array Explorer">
<meta property="og:url" content="https://glebbahmutov.com/blog/drive-by-testing-array-explorer/index.html">
<meta property="og:site_name" content="Better world by better software">
<meta property="og:description" content="TLDR; testing a popular web app using Cypress.   Array Explorer The setup First test Second test Covering primary methods Use JavaScript Simplifying test using aliases Generating tests Fake time Need">
<meta property="og:locale" content="default">
<meta property="og:image" content="https://glebbahmutov.com/blog/images/array-explorer/array-explorer.gif">
<meta property="og:image" content="https://glebbahmutov.com/blog/images/array-explorer/scaffold.png">
<meta property="og:image" content="https://glebbahmutov.com/blog/images/array-explorer/greeting.png">
<meta property="og:image" content="https://glebbahmutov.com/blog/images/array-explorer/array-length.png">
<meta property="og:image" content="https://glebbahmutov.com/blog/images/array-explorer/array-length-test.gif">
<meta property="og:image" content="https://glebbahmutov.com/blog/images/array-explorer/failing-test.png">
<meta property="og:image" content="https://glebbahmutov.com/blog/images/array-explorer/faked-date.png">
<meta property="og:image" content="https://glebbahmutov.com/blog/images/array-explorer/russian-test.png">
<meta property="og:updated_time" content="2018-02-14T02:33:26.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Drive-by Testing Array Explorer">
<meta name="twitter:description" content="TLDR; testing a popular web app using Cypress.   Array Explorer The setup First test Second test Covering primary methods Use JavaScript Simplifying test using aliases Generating tests Fake time Need">
<meta name="twitter:image" content="https://glebbahmutov.com/blog/images/array-explorer/array-explorer.gif">
<meta name="twitter:creator" content="@bahmutov">
  
    <link rel="alternative" href="/blog/atom.xml" title="Better world by better software" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="../css/style.css">
  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-59999353-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <!-- <div id="banner"></div> -->
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="../index.html" id="logo">Better world by better software</a>
      </h1>
      <!--
      
        <h2 id="subtitle-wrap">
          <a href="../index.html" id="subtitle">Gleb Bahmutov PhD</a>
        </h2>
      
      -->
      <!-- <span class="no-mobile">Software advice from</span> -->
      <h2 id="subtitle-wrap">
        <span class="subtitle">
          <a id="subtitle" href="http://glebbahmutov.com">Gleb Bahmutov PhD</a>
        </span>
      </h2>
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
      </nav>
      <nav id="sub-nav">
        <a id="nav-house-link" class="nav-icon" href="/" title="Home"></a>
        
          <a id="nav-rss-link" class="nav-icon" href="/blog/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://glebbahmutov.com/blog"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-drive-by-testing-array-explorer" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="" class="article-date">
  <time datetime="2018-01-08T05:00:00.000Z" itemprop="datePublished">Jan 8 2018</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="../categories/products/">products</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Drive-by Testing Array Explorer
    </h1>

    <h2 class="article-title" itemprop="name">
      Step by step end-to-end testing project &#34;array-explorer&#34;.
    </h2>

  


      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>TLDR; testing a popular web app using Cypress.</p>
<!-- toc -->
<ul>
<li><a href="#array-explorer">Array Explorer</a></li>
<li><a href="#the-setup">The setup</a></li>
<li><a href="#first-test">First test</a></li>
<li><a href="#second-test">Second test</a></li>
<li><a href="#covering-primary-methods">Covering primary methods</a></li>
<li><a href="#use-javascript">Use JavaScript</a></li>
<li><a href="#simplifying-test-using-aliases">Simplifying test using aliases</a></li>
<li><a href="#generating-tests">Generating tests</a></li>
<li><a href="#fake-time">Fake time</a></li>
<li><a href="#need-for-speed">Need for speed</a></li>
<li><a href="#how-do-you-say-test-in">How do you say test in ...</a></li>
<li><a href="#final-thoughts">Final thoughts</a></li>
</ul>
<!-- tocstop -->
<h2><span id="array-explorer">Array Explorer</span></h2><p>Array Explorer is a great resource for learning JavaScript array operations. You can see it in action yourself at <a href="https://sdras.github.io/array-explorer/" target="_blank" rel="noopener">https://sdras.github.io/array-explorer/</a>. Here is me adding items to an array and seeing the result and relevant documentation.</p>
<p><img src="/blog/images/array-explorer/array-explorer.gif" alt="Adding items to an array"></p>
<p>The source for this project is available at <a href="https://github.com/sdras/array-explorer" target="_blank" rel="noopener">github.com/sdras/array-explorer</a> and is written by wonderfully productive <a href="https://sarahdrasnerdesign.com/" target="_blank" rel="noopener">Sarah Drasner</a>. I have noticed that the project does not have any tests. This is a great opportunity to quickly write a few end-to-end tests using <a href="https://github.com/cypress-io/cypress" target="_blank" rel="noopener">Cypress</a> test runner. Just a few high level tests can exercise the entire application <em>as if a real user was interacting with the page</em>.</p>
<p>Let us start testing!</p>
<p><strong>Hint:</strong> Sarah has a sister project <a href="https://github.com/sdras/object-explorer" target="_blank" rel="noopener">sdras/object-explorer</a> that <em>you</em> could test the same way! That would be a great practice for anyone trying out Cypress.</p>
<h2><span id="the-setup">The setup</span></h2><p>First, I need to setup Cypress. Luckily it only takes a minute.</p>
<ul>
<li>I forked the <code>sdras/array-explorer</code> repo to get my own copy</li>
<li>cloned the forked repository to local drive</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ git clone git@github.com:bahmutov/array-explorer.git</span><br><span class="line">$ cd array-explorer</span><br><span class="line">$ git checkout -b add-tests</span><br><span class="line">$ npm install</span><br></pre></td></tr></table></figure>
<p>If we execute <code>npm start</code> right now we will get a local app running at <code>http://localhost:8080</code>. Let us start testing it.</p>
<ul>
<li>I installed Cypress as a dev dependency, and set the <code>test</code> script command.</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm i -D cypress</span><br></pre></td></tr></table></figure>
<figure class="highlight json"><figcaption><span>package.json</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"scripts"</span>: &#123;</span><br><span class="line">    <span class="attr">"test"</span>: <span class="string">"cypress run"</span>,</span><br><span class="line">    <span class="attr">"test:gui"</span>: <span class="string">"cypress open"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>During local development we will be running <code>npm run test:gui</code> which opens Cypress in GUI mode - it is really convenient to see what is going during our tests. On CI we will run Cypress tests in headless mode using <code>cypress run</code> command.</p>
<ul>
<li>when I opened Cypress using <code>npm run test:gui</code> for the very first time, it  scaffolded the test folder <code>cypress</code> and a configuration file <code>cypress.json</code>.</li>
</ul>
<p><img src="/blog/images/array-explorer/scaffold.png" alt="Opening project for the first time"></p>
<h2><span id="first-test">First test</span></h2><ul>
<li>We can rename new file <code>example_spec.js</code> to just <code>spec.js</code> and remove its contents to start from scratch. Notice that Cypress picks up file changes right away; click on the renamed file <code>spec.js</code> in Cypress file list. There no tests yet it says. Here is the first test I wrote.</li>
</ul>
<figure class="highlight js"><figcaption><span>cypress/integration/spec.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">describe(<span class="string">'array-explorer'</span>, () =&gt; &#123;</span><br><span class="line">  beforeEach(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    cy.visit(<span class="string">'http://localhost:8080'</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">  it(<span class="string">'loads'</span>, () =&gt; &#123;&#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>Cypress has noticed file changes and ran it right away. I see the local site in the Cypress iframe (the dev server <code>npm start</code> is still running). Everything is green!</p>
<h2><span id="second-test">Second test</span></h2><p>Let us confirm that the page is greeting us with the name of the project &quot;JavaScript Array Explorer&quot;. For finding unique text on the page, I usually use <a href="https://on.cypress.io/contains" target="_blank" rel="noopener"><code>cy.contains(text)</code></a> command. In this case this text might appear somewhere else on the page. To avoid accidents like this, let us make the selector more precise. Recently we have introduced <a href="https://github.com/cypress-io/cypress/issues/917" target="_blank" rel="noopener">CSS Selector Playground</a> tool. Click on its target icon next to the url bar and hover over the text to see its &quot;best&quot; selector - in this case it suggests using <code>h1</code> selector.</p>
<p><img src="/blog/images/array-explorer/greeting.png" alt="CSS Playground suggests using h1"></p>
<p>Let us update our first test to confirm that the text really greets us after load.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">it(<span class="string">'greets us'</span>, () =&gt; &#123;</span><br><span class="line">  cy.contains(<span class="string">'h1'</span>, <span class="string">'JavaScript Array Explorer'</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>Perfect, the test passes.</p>
<h2><span id="covering-primary-methods">Covering primary methods</span></h2><p>There are 7 primary methods Array Explorer teaches: from &quot;add items or other arrays&quot; to &quot;something else&quot;. We really should create suites of tests for each primary method. In this example I will write just a few example tests. Let me start with &quot;something else&quot; primary method, that has &quot;length of the array&quot; secondary option.</p>
<p>As suggested by the &quot;CSS Selector Playground&quot; helper (or by looking up in the DevTools), the first drop down choice can be queried with <code>#firstmethod</code> selector. The method options can be set in the <code>#methodoptions</code> drop down. Here is our test.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">context(<span class="string">'something else'</span>, () =&gt; &#123;</span><br><span class="line">  it(<span class="string">'shows length of an array'</span>, () =&gt; &#123;</span><br><span class="line">    cy.get(<span class="string">'#firstmethod'</span>).select(<span class="string">'something else'</span>)</span><br><span class="line">    cy.get(<span class="string">'#methodoptions'</span>).select(<span class="string">'find the length of the array'</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p><img src="/blog/images/array-explorer/array-length.png" alt="Array length"></p>
<p>While the test is running I see Cypress opening drop downs, finding the right choice, selecting it. If an element with a given selector was missing and did not appear for the command&#39;s timeout duration, an intelligent error message with a screenshot would appear. But so far everything is going great.</p>
<p>We need to add an assertion to the test. We have not confirmed that the app actually shows an example of the array length property. And we have not confirmed that the output text area is really showing the right answer. Let us do this. The app works in steps</p>
<ol>
<li>Code appears (with slow type effect) in the first box <code>.usage1</code></li>
<li>Then the answer appears in box <code>.usage2 &gt; .usage-code</code></li>
</ol>
<p>Under the hood, the Array Explorer has input and output code as text already in the DOM, just hidden. The input code is supposed to &quot;produce&quot; the output text - it has <code>console.log(...)</code> statements, but of course they are not actually executing. So in our &quot;length of array&quot; example the input looks like this</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">5</span>, <span class="number">1</span>, <span class="number">8</span>];</span><br><span class="line"><span class="built_in">console</span>.log(arr.length);</span><br></pre></td></tr></table></figure>
<p>The output text is <code>3</code> and is initially hidden. Only after delayed &quot;type&quot; effect it appears.</p>
<p>In our test, we can grab the input code as text, and the output text, and we should make sure the output value is visible <em>and correct</em>. To make sure the value is correct, I will <code>eval</code> the input text. Because the input uses <code>console.(...)</code> to &quot;print&quot; the result, before evaluating the code, I will set up a spy on <code>console.log</code> method using built-in [<code>cy.spy</code>][spy] method. Here is the entire test - it kind of looks scary, but it is really universal and can work with any array explorer example!</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">it(<span class="string">'shows length of an array'</span>, () =&gt; &#123;</span><br><span class="line">  cy.get(<span class="string">'#firstmethod'</span>).select(<span class="string">'something else'</span>)</span><br><span class="line">  cy.get(<span class="string">'#methodoptions'</span>).select(<span class="string">'find the length of the array'</span>)</span><br><span class="line">  <span class="comment">// compute the output from input</span></span><br><span class="line">  <span class="keyword">let</span> output</span><br><span class="line">  cy</span><br><span class="line">    .get(<span class="string">'.exampleoutput2'</span>)</span><br><span class="line">    .invoke(<span class="string">'text'</span>)</span><br><span class="line">    .then(<span class="function"><span class="params">t</span> =&gt;</span> &#123;</span><br><span class="line">      output = t</span><br><span class="line">    &#125;)</span><br><span class="line">  <span class="comment">// set up spy on `console.log` before</span></span><br><span class="line">  <span class="comment">// we can call `eval(input code)`</span></span><br><span class="line">  cy.spy(<span class="built_in">console</span>, <span class="string">'log'</span>)</span><br><span class="line">  cy.get(<span class="string">'.usage1'</span>).then(<span class="function"><span class="params">v</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> input = v.text()</span><br><span class="line">    <span class="comment">// evaluate the input code - we are already spying on console.log!</span></span><br><span class="line">    <span class="built_in">eval</span>(input)</span><br><span class="line">    <span class="comment">// the value comes from DOM - so it needs to be</span></span><br><span class="line">    <span class="comment">// converted before we can compare it to the</span></span><br><span class="line">    <span class="comment">// compute value</span></span><br><span class="line">    expect(<span class="built_in">console</span>.log).to.have.been.calledWith(<span class="built_in">JSON</span>.parse(output))</span><br><span class="line">    <span class="comment">// make sure the output becomes visible</span></span><br><span class="line">    cy</span><br><span class="line">      .get(<span class="string">'.exampleoutput2'</span>)</span><br><span class="line">      .should(<span class="string">'have.css'</span>, <span class="string">'opacity'</span>, <span class="string">'1'</span>)</span><br><span class="line">      <span class="comment">// and the right value appears</span></span><br><span class="line">      .and(<span class="string">'contain'</span>, <span class="built_in">String</span>(output))</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>Here is the test in action. Notice an interesting detail that goes to the heart of what makes Cypress great - the intelligent waiting for assertion to pass. The last statement of the test grab the output element and sets up TWO assertions.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cy</span><br><span class="line">  .get(<span class="string">'.exampleoutput2'</span>)</span><br><span class="line">  <span class="comment">// answer becomes visible</span></span><br><span class="line">  .should(<span class="string">'have.css'</span>, <span class="string">'opacity'</span>, <span class="string">'1'</span>)</span><br><span class="line">  <span class="comment">// and the right value appears</span></span><br><span class="line">  .and(<span class="string">'contain'</span>, <span class="built_in">String</span>(output))</span><br></pre></td></tr></table></figure>
<p><strong>Tip:</strong> <code>.and</code> is equivalent to <code>.should</code>. It improves readability when making multiple assertions about the same element.</p>
<p>The video below shows the <em>first</em> asserts waits until the type effect finishes and the app makes the answer visible. Then the second assertion verifies that the right value is in the element.</p>
<p><img src="/blog/images/array-explorer/array-length-test.gif" alt="Array length test"></p>
<p>Cypress fights the unpredictable nature of end-to-end tests by retrying commands for a period of time, and these options are very configurable. The default command timeout of 4 seconds works well for this example, but was too short for other ones. So I increased the command timeout by setting it in <code>cypress.json</code> file</p>
<figure class="highlight json"><figcaption><span>cypress.json</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"viewportHeight"</span>: <span class="number">800</span>,</span><br><span class="line">  <span class="attr">"defaultCommandTimeout"</span>: <span class="number">10000</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2><span id="use-javascript">Use JavaScript</span></h2><p>As my test grows in complexity to handle multiple output values and different edge cases, the code becomes difficult to understand. Luckily, it is just JavaScript. I can refactor the test code as much as I like. I could move utility functions out to separate files and just <code>require</code> or <code>import</code> them. I can bring any NPM module as a dependency and include in my test code.</p>
<p>Back to our test. We can factor out the logic for running the input code sample and comparing it to the output text box. Here is this function with its main parts.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> confirmInputAndOutput = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// get expected output text</span></span><br><span class="line">  <span class="comment">// spy on console.log method</span></span><br><span class="line">  <span class="comment">// get the input code sample</span></span><br><span class="line">  <span class="comment">// eval(input code sample)</span></span><br><span class="line">  <span class="comment">// compare console.log from the spy</span></span><br><span class="line">  <span class="comment">//   with expected output text values</span></span><br><span class="line">  <span class="comment">// check if output box appears and contains output text</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// example test</span></span><br><span class="line">it(<span class="string">'shows length of array'</span>, () =&gt; &#123;</span><br><span class="line">  cy.get(<span class="string">'#firstmethod'</span>).select(<span class="string">'something else'</span>)</span><br><span class="line">  cy.get(<span class="string">'#methodoptions'</span>).select(<span class="string">'find the length of the array'</span>)</span><br><span class="line">  confirmInputAndOutput()</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h2><span id="simplifying-test-using-aliases">Simplifying test using aliases</span></h2><p>A very handy feature to make tests simpler is <a href="https://on.cypress.io/variables-and-aliases" target="_blank" rel="noopener">aliases</a>. Aliases allow saving reference to a DOM element, data or XHR stubs to use later. Here is a fragment of the function that gets the output text and saves several aliases for future use.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> confirmInputAndOutput = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  cy</span><br><span class="line">    .get(<span class="string">'.exampleoutput2'</span>).as(<span class="string">'output'</span>)</span><br><span class="line">    .invoke(<span class="string">'text'</span>).then(removeComments).as(<span class="string">'outputText'</span>)</span><br><span class="line">    .then(parseText).as(<span class="string">'outputValues'</span>)</span><br><span class="line">  <span class="comment">// the test goes on</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>In the above example we save reference to the DOM element as alias <code>output</code>, raw text without comments as alias <code>outputText</code> and parsed JavaScript values as <code>outputValues</code>. Later we can use the aliased values like this</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// eval(input code sample)</span></span><br><span class="line"><span class="comment">// confirm console.log with expected values happened in order</span></span><br><span class="line">cy.get(<span class="string">'@outputValues'</span>).then(<span class="function"><span class="params">outputValues</span> =&gt;</span> &#123;</span><br><span class="line">  outputValues.forEach(<span class="function">(<span class="params">value, k</span>) =&gt;</span> &#123;</span><br><span class="line">    expect(<span class="built_in">console</span>.log.getCall(k)).to.have.been.calledWith(value)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// make sure the output text actually appears</span></span><br><span class="line">cy.get(<span class="string">'@outputText'</span>).then(<span class="function"><span class="params">outputText</span> =&gt;</span> &#123;</span><br><span class="line">  cy.get(<span class="string">'@output'</span>).should(<span class="string">'have.css'</span>, <span class="string">'opacity'</span>, <span class="string">'1'</span>)</span><br><span class="line">  <span class="comment">// the only difficulty is with multiline text where there might</span></span><br><span class="line">  <span class="comment">// be white space at the start of each line</span></span><br><span class="line">  outputText</span><br><span class="line">    .split(<span class="string">'\n'</span>)</span><br><span class="line">    .map(trim)</span><br><span class="line">    .forEach(<span class="function"><span class="params">line</span> =&gt;</span> &#123;</span><br><span class="line">      cy.get(<span class="string">'@output'</span>).should(<span class="string">'contain'</span>, line)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>Aliases are great way to avoid deep nesting or temporary variables.</p>
<h2><span id="generating-tests">Generating tests</span></h2><p>I wrote a couple of other tests: &quot;fill array ...&quot;, &quot;copy a sequence of elements ...&quot;. They all work the same way - set the desired method example and call <code>confirmInputAndOutput</code>. The spec file kind of looks boring.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">context(<span class="string">'something else'</span>, () =&gt; &#123;</span><br><span class="line">  beforeEach(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    cy.get(<span class="string">'#firstmethod'</span>).select(<span class="string">'something else'</span>)</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  it(<span class="string">'shows length of an array'</span>, () =&gt; &#123;</span><br><span class="line">    selectMethodOptions(<span class="string">'find the length of the array'</span>)</span><br><span class="line">    confirmInputAndOutput()</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  it(<span class="string">'fills array with given value'</span>, () =&gt; &#123;</span><br><span class="line">    selectMethodOptions(</span><br><span class="line">      <span class="string">'fill all the elements of the array with a static value'</span></span><br><span class="line">    )</span><br><span class="line">    confirmInputAndOutput()</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  it(<span class="string">'copy a sequence of array elements within the array'</span>, () =&gt; &#123;</span><br><span class="line">    selectMethodOptions(<span class="string">'copy a sequence of array elements within the array.'</span>)</span><br><span class="line">    confirmInputAndOutput()</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>All tests are going to look like this. Can we generate the tests from a list of options? Yes we can. Instead of writing individual <code>it(..., () =&gt; {...})</code> calls, I placed all primary method names and corresponding option names into an object of arrays. A small helper function iterates over the arrays, creating tests.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> methods = &#123;</span><br><span class="line">  <span class="string">'order an array'</span>: [</span><br><span class="line">    <span class="string">'reverse the order of the array'</span>,</span><br><span class="line">    <span class="string">'sort the items of the array'</span>,</span><br><span class="line">  ],</span><br><span class="line">  <span class="string">'something else'</span>: [</span><br><span class="line">    <span class="string">'find the length of the array'</span>,</span><br><span class="line">    <span class="string">'fill all the elements of the array with a static value'</span>,</span><br><span class="line">    <span class="string">'copy a sequence of array elements within the array.'</span>,</span><br><span class="line">  ],</span><br><span class="line">  <span class="comment">// a lot more methods ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">Object</span>.keys(methods).forEach(<span class="function"><span class="params">method</span> =&gt;</span> &#123;</span><br><span class="line">  context(method, () =&gt; &#123;</span><br><span class="line">    beforeEach(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      cy.get(<span class="string">'#firstmethod'</span>).select(method)</span><br><span class="line">    &#125;)</span><br><span class="line">    methods[method].forEach(<span class="function"><span class="params">secondary</span> =&gt;</span> &#123;</span><br><span class="line">      it(secondary, () =&gt; &#123;</span><br><span class="line">        selectMethodOptions(secondary)</span><br><span class="line">        confirmInputAndOutput()</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>One short spec file is running 20 tests checking all array method examples (except for &quot;find&quot; method that requires extra arguments)</p>
<h2><span id="fake-time">Fake time</span></h2><p>One test is failing. Can you spot the problem?</p>
<p><img src="/blog/images/array-explorer/failing-test.png" alt="Failing test"></p>
<p>The input code sample uses current date!</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">5</span>, <span class="number">1</span>, <span class="number">8</span>];</span><br><span class="line"><span class="keyword">let</span> date = [<span class="keyword">new</span> <span class="built_in">Date</span>()];</span><br><span class="line"><span class="keyword">const</span> arrString = arr.toLocaleString();</span><br><span class="line"><span class="keyword">const</span> dateString = date.toLocaleString();</span><br><span class="line"><span class="built_in">console</span>.log(arrString, dateString);</span><br></pre></td></tr></table></figure>
<p>The expected output is hardcoded to be &quot;12/26/2017, 6:54:49 PM&quot;, which will never match the evaluated input code. What can we do? Ordinarily, Cypress tests use <a href="https://on.cypress.io/clock" target="_blank" rel="noopener"><code>cy.clock</code></a> to control the time inside the running application like this</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">beforeEach(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> now = <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="string">'12/26/2017, 6:54:49 PM'</span>).getTime()</span><br><span class="line">  cy.clock(now)</span><br><span class="line">  cy.visit(<span class="string">'http://localhost:8080'</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>But our use case is different. It is NOT the application that is calling <code>new Date()</code>, but our unit test via <code>eval</code>.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">eval</span>(<span class="string">`</span></span><br><span class="line"><span class="string">let arr = [5, 1, 8];</span></span><br><span class="line"><span class="string">let date = [new Date()];</span></span><br><span class="line"><span class="string">const arrString = arr.toLocaleString();</span></span><br><span class="line"><span class="string">const dateString = date.toLocaleString();</span></span><br><span class="line"><span class="string">console.log(arrString, dateString);</span></span><br><span class="line"><span class="string">`</span>)</span><br></pre></td></tr></table></figure>
<p>Thus our <em>test code</em> must fake the date. Luckily, Cypress has <a href="http://sinonjs.org/" target="_blank" rel="noopener">Sinon</a> bundled and available under <code>Cypress.sinon</code> property. Right before we evaluate our code we can fake the <code>Date</code> object.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> clock = Cypress.sinon.useFakeTimers(</span><br><span class="line">  <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="string">'12/26/2017, 6:54:49 PM'</span>).getTime()</span><br><span class="line">)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">// evaluate the input code - we are already spying on console.log!</span></span><br><span class="line">  <span class="built_in">eval</span>(<span class="string">'const Date = clock.Date;'</span> + sourceCode)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// don't forget to restore system clock</span></span><br><span class="line"><span class="comment">// otherwise good things will not happen</span></span><br><span class="line">clock.restore()</span><br></pre></td></tr></table></figure>
<p>Tricking <code>eval</code> to use local variable via closure is one of my <a href="../faking-lexical-scope/">favorite JS tricks</a>. Aside from this, I changed the original example a little bit. I split the single <code>console.log</code> to be two statements to better match what every example is doing and what my tests expect.</p>
<p><img src="/blog/images/array-explorer/faked-date.png" alt="Passing test after faking current time"></p>
<p><strong>Note</strong> the alises are highlighted when saved (pink and blue rounded labels <code>output</code> and <code>outputValues</code>). They are also highlighted with <code>@...</code> label when used.</p>
<h2><span id="need-for-speed">Need for speed</span></h2><p>The tests are passing, but there is one negative. They take too long to finish - 67 seconds! The main reason each tests takes a few seconds are the delays built into the app. There is half a second delay to let the user read the first line of the example code, then there is the &quot;type&quot; effect that uses <code>gsap</code> library to reveal the rest of the example code.</p>
<figure class="highlight js"><figcaption><span>AppCode.vue</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">selectedUsage() &#123;</span><br><span class="line">  <span class="comment">// initial delay</span></span><br><span class="line">  setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">this</span>.typeOut()</span><br><span class="line">  &#125;, <span class="number">500</span>)</span><br><span class="line">&#125;,</span><br><span class="line">typeOut() &#123;</span><br><span class="line">  <span class="keyword">let</span> split = <span class="keyword">new</span> SplitText(<span class="keyword">this</span>.$refs.ex, &#123; <span class="attr">type</span>: <span class="string">'chars'</span> &#125;),</span><br><span class="line">    split2 = <span class="keyword">new</span> SplitText(<span class="keyword">this</span>.$refs.ex2, &#123; <span class="attr">type</span>: <span class="string">'chars'</span> &#125;),</span><br><span class="line">    tl = <span class="keyword">new</span> TimelineMax()</span><br><span class="line"></span><br><span class="line">  tl.add(<span class="string">'start'</span>)</span><br><span class="line">  <span class="comment">// animation keyframes</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>The <a href="https://github.com/greensock/GreenSock-JS" target="_blank" rel="noopener">gsap</a> is JavaScript animation library, so maybe if we can &quot;speed&quot; up application&#39;s timers we can zoom through the type animation and make our tests faster. While Sinon includes timers, I found <a href="https://github.com/sinonjs/lolex" target="_blank" rel="noopener">lolex</a> to be the most convenient library to work with fake timers. Luckily using this from our tests is very simple.</p>
<p>First, install <code>lolex</code> as a new dev dependency.
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ npm i -D lolex</span><br><span class="line">+ lolex@2.3.1</span><br></pre></td></tr></table></figure></p>
<p>Second, install fake timers into the application <em>before</em> the application loads. We can do this in the callback <code>onBeforeLoad</code> of the <a href="https://on.cypress.io/visit" target="_blank" rel="noopener"><code>cy.visit</code></a> method. It is important to pass the application&#39;s window as the target for stubbing timers.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> fakeClock</span><br><span class="line">beforeEach(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  cy.visit(<span class="string">'http://localhost:8080'</span>, &#123;</span><br><span class="line">    onBeforeLoad: <span class="function"><span class="params">win</span> =&gt;</span> &#123;</span><br><span class="line">      fakeClock = lolex.install(&#123;</span><br><span class="line">        target: win,</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>Inside the test logic we can manually advance the clock after the source code appears and the app called its <code>setTimeout</code> (which is now stubbed).</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> confirmInputAndOutput = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  cy</span><br><span class="line">    .get(<span class="string">'.exampleoutput2'</span>).as(<span class="string">'output'</span>)</span><br><span class="line">    .invoke(<span class="string">'text'</span>).then(removeComments).as(<span class="string">'outputText'</span>)</span><br><span class="line">    .then(parseText).as(<span class="string">'outputValues'</span>)</span><br><span class="line">    .then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      fakeClock.tick(<span class="number">10000</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">  <span class="comment">// the test goes on</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>The generous 10 second time jump completes the initial delay of 500ms and instantly zooms through any typing animation the app makes. The result is awesome - total time to finish all tests goes down from 67 seconds to 27 seconds!</p>
<h2><span id="how-do-you-say-test-in">How do you say test in ...</span></h2><p>The last thing I will do is write a test to make sure the language selector works. Because the language selection element does not have a good way to access it I have added <code>data-attr-cy</code> attribute</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">v-model</span>=<span class="string">"selectedLanguage"</span> <span class="attr">data-attr-cy</span>=<span class="string">"language"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">option</span> <span class="attr">v-for</span>=<span class="string">"(val, key) in languages"</span> <span class="attr">:value</span>=<span class="string">"key"</span>&gt;</span>&#123;&#123;val.long&#125;&#125;<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>The test can use this data attribute to get the right selection element. After selecting the desired language (I am picking my native Russian), we use the same test logic as before.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">it(<span class="string">'works in Russian'</span>, () =&gt; &#123;</span><br><span class="line">  cy.get(<span class="string">'[data-attr-cy="language"'</span>).select(<span class="string">'Russian'</span>)</span><br><span class="line">  selectMethod(<span class="string">'удалить элементы'</span>) <span class="comment">// remove elements</span></span><br><span class="line">  selectMethodOptions(<span class="string">'первый элемент массива'</span>) <span class="comment">// first element of the array</span></span><br><span class="line">  confirmInputAndOutput()</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p><img src="/blog/images/array-explorer/russian-test.png" alt="In Soviet Russia array removes you"></p>
<p><strong>Tip:</strong> we could have imported data for different languages directly from the <code>store/&lt;language&gt;</code> files. Then we could actually iterate and create full test suites for <em>every</em> language. After all, out tests are JavaScript and can share code with the web app itself!</p>
<h2><span id="final-thoughts">Final thoughts</span></h2><p>Here is the final result - the <a href="https://github.com/bahmutov/array-explorer/blob/9a07cc43734c150f170cececb5b3f76ce1af9851/cypress/integration/spec.js" target="_blank" rel="noopener">spec.js file</a> and the screen recording of the running tests. The tests take longer than 27 seconds because my laptop is choking a little bit during while doing full screen recording.</p>
<iframe width="853" height="480" src="https://www.youtube.com/embed/0t5rkNbN6sY?rel=0" frameborder="0" gesture="media" allow="encrypted-media" allowfullscreen></iframe>

<p>I have opened a pull request <a href="https://github.com/sdras/array-explorer/pull/70" target="_blank" rel="noopener">sdras/array-explorer/pull/70</a> to merge these tests into the Array Explorer. Maybe these tests can inspire you to add tests to <a href="https://github.com/sdras/object-explorer" target="_blank" rel="noopener">sdras/object-explorer</a>?</p>
<p>You can find more information about Cypress from these links</p>
<ul>
<li><a href="https://www.cypress.io/" target="_blank" rel="noopener">https://www.cypress.io/</a></li>
<li><a href="https://on.cypress.io/intro" target="_blank" rel="noopener">https://on.cypress.io/intro</a></li>
<li><a href="https://www.cypress.io/blog/" target="_blank" rel="noopener">https://www.cypress.io/blog/</a></li>
<li><a href="../tags/cypress/">https://glebbahmutov.com/blog/tags/cypress/</a></li>
<li><a href="https://on.cypress.io/talks-media" target="_blank" rel="noopener">https://on.cypress.io/talks-media</a></li>
</ul>

      
    </div>

    
      <footer class="article-footer personal-links">
  Follow Gleb Bahmutov <a href="https://twitter.com/bahmutov">@bahmutov</a>,
  see his projects at <a href="http://glebbahmutov.com">glebbahmutov.com</a>
</footer>
<script src="https://rawgit.com/toddmotto/linkjuice/702066a37124081e7ad1a972844a9a91115be05a/dist/linkjuice.js"></script>
<script>
function contentFn (node, icon) {
  const s = '<a href="#' + node.id + '" class="linkjuice">' +
    node.innerHTML + ' ' + icon + '</a>\n'
  return s
}
linkjuice.init('.article-entry', {
  selectors: ['h2 span'],
  icon: '<span class="link-symbol">#</span>',
  contentFn: contentFn
});
</script>

    

    <footer class="article-footer">
      <a data-url="https://glebbahmutov.com/blog/drive-by-testing-array-explorer/" data-id="cjoi5gok3009xzmoorj34g0u6" class="article-share-link">Share</a>
      
        <a href="https://glebbahmutov.com/blog/drive-by-testing-array-explorer/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="../tags/cypress/">cypress</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="../tags/testing/">testing</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="../tags/vuejs/">vuejs</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="../testing-es6-module-in-cypress-electron/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Testing ES6 Module in Cypress Electron Browser
        
      </div>
    </a>
  
  
    <a href="../testing-vue-cli-reload/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Testing Vue CLI reload</div>
    </a>
  
</nav>

  
</article>


<section id="comments">
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</section>

</section>
        
          <aside id="sidebar">
  
    <style>
#carbonads {
  display: block;
  overflow: hidden;
  font-size: 11px;
  font-family: Verdana, "Helvetica Neue", Helvetica, sans-serif;
  line-height: 1.5;
}

#carbonads a {
  color: #258fb8;
  text-decoration: none;
}

#carbonads a:hover {
  text-decoration: underline;
}

#carbonads span {
  position: relative;
  display: block;
  overflow: hidden;
}

.carbon-img {
  float: left;
  margin-right: 1em;
}

.carbon-img img { display: block; }

.carbon-text {
  display: block;
  float: left;
  text-align: left;
  margin-top: 0.5em;
}
@media screen and (min-width: 1024px) {
  .carbon-text {
    max-width: calc(100% - 130px - 1em);
  }
}

.carbon-poweredby {
  /*position: absolute;
  right: 0;
  bottom: 0;*/
  float: right;
  display: block;
  font-size: 11px;
}
</style>
<div class="widget-wrap">
  <div class="widget-title">&nbsp;</div>
  <div class="widget">
    <!-- Carbon Ads -->
    <script async type="text/javascript"
      src="//cdn.carbonads.com/carbon.js?zoneid=1673&serve=C6AILKT&placement=glebbahmutovcom"
      id="_carbonads_js"></script>
  </div>
</div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="../categories/book-review/">book review</a><span class="category-list-count">15</span></li><li class="category-list-item"><a class="category-list-link" href="../categories/people/">people</a><span class="category-list-count">17</span></li><li class="category-list-item"><a class="category-list-link" href="../categories/process/">process</a><span class="category-list-count">104</span></li><li class="category-list-item"><a class="category-list-link" href="../categories/products/">products</a><span class="category-list-count">296</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="../tags/QUnit/">QUnit</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/advice/">advice</a><span class="tag-list-count">98</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/angularjs/">angularjs</a><span class="tag-list-count">58</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/angularjs2/">angularjs2</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/assertions/">assertions</a><span class="tag-list-count">9</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/ast/">ast</a><span class="tag-list-count">8</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/boilerplate/">boilerplate</a><span class="tag-list-count">14</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/browser/">browser</a><span class="tag-list-count">18</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/ci/">ci</a><span class="tag-list-count">8</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/concurrency/">concurrency</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/cyclejs/">cyclejs</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/cypress/">cypress</a><span class="tag-list-count">23</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/d3/">d3</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/db/">db</a><span class="tag-list-count">11</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/docker/">docker</a><span class="tag-list-count">10</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/es6/">es6</a><span class="tag-list-count">13</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/es7/">es7</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/functional/">functional</a><span class="tag-list-count">67</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/generators/">generators</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/git/">git</a><span class="tag-list-count">12</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/github/">github</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/graphql/">graphql</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/grunt/">grunt</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/gulp/">gulp</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/hyperapp/">hyperapp</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/immutable/">immutable</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/interview/">interview</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/jade/">jade</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/javascript/">javascript</a><span class="tag-list-count">160</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/jshint/">jshint</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/modular-development/">modular development</a><span class="tag-list-count">27</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/nodejs/">nodejs</a><span class="tag-list-count">74</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/performance/">performance</a><span class="tag-list-count">17</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/presentation/">presentation</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/promises/">promises</a><span class="tag-list-count">31</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/proposal/">proposal</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/ramda/">ramda</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/reactive/">reactive</a><span class="tag-list-count">12</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/reactjs/">reactjs</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/screencast/">screencast</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/security/">security</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/sentry/">sentry</a><span class="tag-list-count">10</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/service-workers/">service workers</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/testing/">testing</a><span class="tag-list-count">80</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/tutorial/">tutorial</a><span class="tag-list-count">10</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/typescript/">typescript</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/ui/">ui</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/vuejs/">vuejs</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/web-workers/">web workers</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="../tags/zeit/">zeit</a><span class="tag-list-count">1</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="../tags/QUnit/" style="font-size: 11.67px;">QUnit</a> <a href="../tags/advice/" style="font-size: 19.58px;">advice</a> <a href="../tags/angularjs/" style="font-size: 17.92px;">angularjs</a> <a href="../tags/angularjs2/" style="font-size: 10px;">angularjs2</a> <a href="../tags/assertions/" style="font-size: 13.33px;">assertions</a> <a href="../tags/ast/" style="font-size: 12.92px;">ast</a> <a href="../tags/boilerplate/" style="font-size: 15.42px;">boilerplate</a> <a href="../tags/browser/" style="font-size: 16.25px;">browser</a> <a href="../tags/ci/" style="font-size: 12.92px;">ci</a> <a href="../tags/concurrency/" style="font-size: 10px;">concurrency</a> <a href="../tags/cyclejs/" style="font-size: 12.5px;">cyclejs</a> <a href="../tags/cypress/" style="font-size: 16.67px;">cypress</a> <a href="../tags/d3/" style="font-size: 10.83px;">d3</a> <a href="../tags/db/" style="font-size: 14.17px;">db</a> <a href="../tags/docker/" style="font-size: 13.75px;">docker</a> <a href="../tags/es6/" style="font-size: 15px;">es6</a> <a href="../tags/es7/" style="font-size: 10px;">es7</a> <a href="../tags/functional/" style="font-size: 18.33px;">functional</a> <a href="../tags/generators/" style="font-size: 11.67px;">generators</a> <a href="../tags/git/" style="font-size: 14.58px;">git</a> <a href="../tags/github/" style="font-size: 10.42px;">github</a> <a href="../tags/graphql/" style="font-size: 10.42px;">graphql</a> <a href="../tags/grunt/" style="font-size: 12.5px;">grunt</a> <a href="../tags/gulp/" style="font-size: 10.83px;">gulp</a> <a href="../tags/hyperapp/" style="font-size: 12.08px;">hyperapp</a> <a href="../tags/immutable/" style="font-size: 11.67px;">immutable</a> <a href="../tags/interview/" style="font-size: 10.83px;">interview</a> <a href="../tags/jade/" style="font-size: 11.25px;">jade</a> <a href="../tags/javascript/" style="font-size: 20px;">javascript</a> <a href="../tags/jshint/" style="font-size: 10.83px;">jshint</a> <a href="../tags/modular-development/" style="font-size: 17.08px;">modular development</a> <a href="../tags/nodejs/" style="font-size: 18.75px;">nodejs</a> <a href="../tags/performance/" style="font-size: 15.83px;">performance</a> <a href="../tags/presentation/" style="font-size: 11.25px;">presentation</a> <a href="../tags/promises/" style="font-size: 17.5px;">promises</a> <a href="../tags/proposal/" style="font-size: 10.42px;">proposal</a> <a href="../tags/ramda/" style="font-size: 10px;">ramda</a> <a href="../tags/reactive/" style="font-size: 14.58px;">reactive</a> <a href="../tags/reactjs/" style="font-size: 10.83px;">reactjs</a> <a href="../tags/screencast/" style="font-size: 10px;">screencast</a> <a href="../tags/security/" style="font-size: 12.5px;">security</a> <a href="../tags/sentry/" style="font-size: 13.75px;">sentry</a> <a href="../tags/service-workers/" style="font-size: 12.08px;">service workers</a> <a href="../tags/testing/" style="font-size: 19.17px;">testing</a> <a href="../tags/tutorial/" style="font-size: 13.75px;">tutorial</a> <a href="../tags/typescript/" style="font-size: 10.42px;">typescript</a> <a href="../tags/ui/" style="font-size: 10.42px;">ui</a> <a href="../tags/vuejs/" style="font-size: 11.25px;">vuejs</a> <a href="../tags/web-workers/" style="font-size: 12.08px;">web workers</a> <a href="../tags/zeit/" style="font-size: 10px;">zeit</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="../archives/2018/11/">November 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2018/10/">October 2018</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2018/09/">September 2018</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2018/08/">August 2018</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2018/06/">June 2018</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2018/04/">April 2018</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2018/03/">March 2018</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2018/02/">February 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2018/01/">January 2018</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2017/12/">December 2017</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2017/11/">November 2017</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2017/09/">September 2017</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2017/08/">August 2017</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2017/07/">July 2017</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2017/06/">June 2017</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2017/05/">May 2017</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2017/04/">April 2017</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2017/03/">March 2017</a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2017/02/">February 2017</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2017/01/">January 2017</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2016/12/">December 2016</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2016/11/">November 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2016/10/">October 2016</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2016/09/">September 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2016/08/">August 2016</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2016/07/">July 2016</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2016/06/">June 2016</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2016/05/">May 2016</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2016/04/">April 2016</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2016/03/">March 2016</a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2016/02/">February 2016</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2016/01/">January 2016</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/12/">December 2015</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/11/">November 2015</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/10/">October 2015</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/09/">September 2015</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/08/">August 2015</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/07/">July 2015</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/06/">June 2015</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/05/">May 2015</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/04/">April 2015</a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/03/">March 2015</a><span class="archive-list-count">15</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/02/">February 2015</a><span class="archive-list-count">13</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2015/01/">January 2015</a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/12/">December 2014</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/11/">November 2014</a><span class="archive-list-count">19</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/10/">October 2014</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/09/">September 2014</a><span class="archive-list-count">13</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/08/">August 2014</a><span class="archive-list-count">12</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/07/">July 2014</a><span class="archive-list-count">13</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/06/">June 2014</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/05/">May 2014</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/04/">April 2014</a><span class="archive-list-count">13</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/03/">March 2014</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/02/">February 2014</a><span class="archive-list-count">12</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2014/01/">January 2014</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2013/12/">December 2013</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2013/11/">November 2013</a><span class="archive-list-count">14</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2013/10/">October 2013</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="../archives/2013/09/">September 2013</a><span class="archive-list-count">10</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="../element-coverage/">Element coverage for end-to-end tests</a>
          </li>
        
          <li>
            <a href="../use-github-instead-of-npm/">Use GitHub instead of NPM</a>
          </li>
        
          <li>
            <a href="../cypress-jump/">Cypress jump</a>
          </li>
        
          <li>
            <a href="../mock-graphql-with-lunar-in-cypress-tests/">Mocking GraphQL with Lunar in Cypress End-to-End Tests</a>
          </li>
        
          <li>
            <a href="../good-logging/">Good logging</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2018 Gleb Bahmutov<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
</nav>
    
<script>
  var disqus_shortname = 'betterworldbybettersoftware';
  
  var disqus_url = 'https://glebbahmutov.com/blog/drive-by-testing-array-explorer/';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="../fancybox/jquery.fancybox.css">
  <script src="../fancybox/jquery.fancybox.pack.js"></script>


<script src="../js/script.js"></script>

  </div>
  <script src="https://cdn.jsdelivr.net/lodash/4.17.4/lodash.min.js"></script>
<script>
(function centerMainOnAsideScroll () {
  // when aside side bar scrolls outside the view
  // it centers the main content.
  const main = document.querySelector('#main')
  const aside = document.querySelector('aside#sidebar')
  console.assert(main, 'could not get #main')
  console.assert(aside, 'could not get aside')
  // initially the aside sidebar is visible
  let asideVisible = true

  function centerMain () {
    console.log('adding class center-main')
    main.classList.add('center-main')
  }
  function leftMain () {
    main.classList.remove('center-main')
  }

  function callWhenAsideScrollsUp (becameInvisible, becameVisible) {
    return function () {
      const border = 50
      const rect = aside.getBoundingClientRect()
      if (asideVisible && rect.bottom < -border) {
        asideVisible = false
        becameInvisible()
      }

      if (!asideVisible && window.scrollY < border) {
        asideVisible = true
        becameVisible()
      }
    }
  }
  const throttleWaitMs = 250
  const onScroll = _.throttle(
    callWhenAsideScrollsUp(centerMain, leftMain),
    throttleWaitMs
  )
  window.addEventListener('scroll', onScroll)
}())
</script>

</body>
</html>
